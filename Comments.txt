Действительно забыл про тех users, которые ничего не заказывали (т.е. у которых нет завершённых заказов).
Переделал все три метрики под таких пользователей.
Также заново выгрузил первые 10 пользователей из витрины (витрину тоже обновил).

Что касается скрипта создания витрины, то ограничение check задавал там таким образом:
CHECK (frequency in (1,2,3,4,5))
Такая запись выглядит несколько короче, чем (frequency >= 1 and frequency <= 5) + в моём варианте сразу
видны все возможные значения - т.е. код получается самодокументируемым.
Просто не сохранился запрос и поэтому для загрузки на github сгенерировал его в dbeaver.
Там мне и сгенерировалась эта версия с arrays.
